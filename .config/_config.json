{
  "vars": {
    "routerport": 8443,
    "ciport": 7501,
    "logport": 7502,
    "logbackendport": 7503,
    "dashboardport": 7504,
    "certbotport": "7505"
  },
  "processes": {
    "log": {
      "script": "./.build/logserver.js",
      "args": [
        "${logport}",
        "${logbackendport}"
      ]
    },
    "dashboard": {
      "script": "./.build/dashboard.js",
      "args": {
        "dashboardport": "${dashboardport}",
        "ciport": "${ciport}",
        "logbackendport": "${logbackendport}",
        "token": "abc123"
      }
    },
    "certbot": {
      "args": "${certbotport}",
      "cwd": "../certbot",
      "script": "../certbot/server.js"
    },
    "router": {
      "script": "./.build/router.js",
      "args": {
        "port": "${routerport}",
        "http_redirect": "8080->443",
        "routes": {
          "^[^/]*/admin": "${dashboardport}",
          "^[^/]*/.well-known/acme-challenge": "${certbotport}",
          "^[^/]*/webhook/": "${ciport}"
        },
        "webroots": {
          "localhost/some/service": 8000
        },
        "host": "::"
      }
    }
  },
  "webhooks": {
    "adabru-server": {
      "token": "abc123",
      "path": ".",
      "commands": "for f in *.ls; do if [ \"$f\" -nt \".build/${f%.ls}.js\" ] ; then lsc -o .build -c \"$f\" ; fi ; done\nstylus -o ./.build .\nwebpack --mode=production\n"
    }
  }
}
