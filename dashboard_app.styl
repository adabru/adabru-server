
feedback()
  pending(col)
    $name = unquote('pending-' + substr(s("%s", col),1,3))
    @keyframes {$name}
      0%   { box-shadow: col 0px 0px 10px inset }
      50%  { box-shadow: col 0px 0px 50px inset }
      100% { box-shadow: col 0px 0px 10px inset }
    animation-iteration-count: infinite
    animation-name: $name
    animation-duration: 1s
  pulse(col)
    $name = unquote('pulse-' + substr(s("%s", col),1,3))
    @keyframes {$name}
      0%   { background: rgba(col, .0) }
      10%  { background: rgba(col, .8) }
      15%  { background: rgba(col, .3) }
      20%  { background: rgba(col, .8) }
      50%  { background: rgba(col, .4) }
      100% { background: rgba(col, .0) }
    animation-iteration-count: 1
    animation-name: $name
    animation-duration: 1s
  // flash
  &:after
    top: 0
    left: 0
    content: ' '
    position: absolute
    width: 100%
    height: 100%
    transition-duration: 1s
    pointer-events: none
    z-index: 1
  &.pending:after
    pointer-events: all
    cursor: wait
    pending #ccf
  &.success:after
    pulse #0c0
  &.failure:after
    pulse #c00

button
  background: #bad
  border: 5px groove #fcf
  color: #fcf
  height: 46px
  margin: 2px
  font-size: 2em
  box-sizing: border-box


body
  background-color: #fff
  margin: 0
  button { cursor: pointer }

.dashboard
  display: flex
  flex-direction: column
  height: 100%
  header
    background: #a6a
    align-items: center
    flex-shrink: 0
    display: flex
    height: 3em
    textarea
      resize: none
      white-space: nowrap
      overflow: hidden
      height: 90%
      width: 5em
  .heartbeat
    margin-right: auto
    font-size: 2em
    width: 1.5em
    cursor: wait
    text-align: center
    padding: 5px
    color: #aaa
    &.phase0
      @keyframes phase0
        0%   { font-size: 2.5em ; color: #fac ; text-shadow: 0px 0px 50px #f33 }
        20%  { font-size: 2em ; color: #fac ; text-shadow: 0px 0px 40px #f33 }
        80%  { font-size: 2em ; color: #fac ; text-shadow: 0px 0px 5px #f33 }
        100% { font-size: 2em ; color: #aaa ; text-shadow: 0px 0px 0px #f330 }
      animation-iteration-count: 1
      animation-name: phase0
      animation-duration: 5s
    &.phase1
      @keyframes phase1
        0%   { font-size: 2.5em ; color: #fac ; text-shadow: 0px 0px 50px #f33 }
        20%  { font-size: 2em ; color: #fac ; text-shadow: 0px 0px 40px #f33 }
        80%  { font-size: 2em ; color: #fac ; text-shadow: 0px 0px 5px #f33 }
        100% { font-size: 2em ; color: #aaa ; text-shadow: 0px 0px 0px #aaa }
      animation-iteration-count: 1
      animation-name: phase1
      animation-duration: 5s
  .token
    margin-left: 50px
    padding: 5px
    background: #fef

// process listing
.procs
  overflow-y: scroll
  flex-grow: 1
  text-align: center
  width: 100%
  .proc
    border-bottom: 3px solid #888
    display: flex
    align-items: center

// process headerline
.proc
  font: 1em sans-serif
  position: relative
  feedback()
  .status { width: 2em }
  .name { width: 5em }
  .start, .stop, .restart
    padding: 5px
    border: none
    background: #0000
    color: #000
    font-size: 1em
  .start:hover { text-shadow: 2px 2px 2px #0f0 }
  .restart:hover { text-shadow: 2px 2px 2px #ff0 }
  .stop:hover { text-shadow: 2px 2px 2px #f00 }
  .pid
    width: 4em
    font: 1em monospace
    position: relative
    &:hover .ports { visibility: visible }
    .ports
      visibility: hidden
      position: absolute
      color: #000
      background: #fff
      font: 1em monospace
      span { padding: 5px }
      z-index: 1
  .logwrapOuter
    background: #cce
    width: 30%
    .logwrapInner
      height: 100%
      overflow: visible
      position: relative
      .log
        width: 100%
        bottom: 0
        position: absolute
  .config
    width: 30%


// process status
.proc
  &.running
    background: #cfc
    color: #080
    .start { visibility: hidden }
  &.notrunning
    background: #ffc
    color: #880
    .stop, .restart { visibility: hidden }
  &.stopped
    background: #caa
    .name { color: #600 }
    .start { visibility: hidden }

.addproc
  display: block
  width: 2em

// log
.proc .log
  display: grid
  .entry
    &:nth-child(2n) { background: #cce }
    &:nth-child(2n+1) { background: #c4c4e0 }
    display: inline-flex
    pre { margin: 0 ; text-align: left }
    .date
      color: #e49
      &.s { background: #f99 }
      &.m { background: #faa }
      &.h { background: #fbb }
      &.d { background: #fcc }
      &.w { background: #fdd }
      &.o { background: #fee }
      &.y { background: #fee }
      user-select: none
      font-size: .8em
      letter-spacing: 2px
      min-width: 40px
      text-align: center

// config
.proc .config
  align-self: baseline
  position: relative
  feedback()
  .buttons { display: flex }
  .buttons > button
    flex-grow: 1
    &.locked
      &:before { content: 'ðŸ”’'; color: #fcf }
      &:after { content: 'ðŸ”“'; color: #c6f }
    &.unlocked
      &:before { content: 'ðŸ”’'; color: #c6f }
      &:after { content: 'ðŸ”“'; color: #fcf }
  & > input
    display: block
    margin: auto
.proc.expand .config
  .buttons > button
    &:nth-child(1) { flex-grow: 3 }
    &:nth-child(2) { flex-grow: 1; color: #fdd; background: #e88; border: 5px groove #fdd }
    &:nth-child(3) { flex-grow: 6 }

// expanding
.procs .proc
  .logwrapOuter, .config
    overflow: hidden
    height: 50px
    transition-duration: .1s
  &.expand
    .logwrapOuter
      overflow-x: auto
      overflow-y: hidden
      height: 300px
    .config
      height: auto




// jsoneditor

.json-stem
  display: flex
  & > button
    background: #c6f3
    padding: 0 5px
    border: none
    margin: 0
    &:hover { background: #c6f6 }
    font-size: .5em
    height: 3em
    &:nth-child(1) { border-radius: 0 0 0 15px }
    // 1px for shadow issue
    &:nth-child(2) { border-radius: 0 0 0 1px }
    &:nth-child(3) { border-radius: 0 0 15px 0 }

.json-string
  overflow: hidden
  width: 300px
  height: 300px
  max-width: 100%
  min-width: 100%
  max-height: 250px
  max-width: 250px
  padding: 2px
  resize: none
  white-space: pre
  border: none
  border-radius: 0 0 15px 15px
  &:focus
    overflow: auto
    max-width: calc(100%)
    max-height: calc(100%)
  &::placeholder
    color: #ddd

.json-array
  background: #8854
  padding: 2px
  box-sizing: border-box
  display: flex
  flex-wrap: wrap
  list-style: none
  > li
    display: flex
    flex-direction: column
    margin: 1px 1px
    & > button
      border-radius: 15px 15px 0 0
      border-style: groove
      border-width: 1px
      padding: 8px
      margin: 0
      width: 100%
      height: 1.5em
      font: inherit
      background: #c6f6
      &:hover { background: #f386 }
    & > button:last-child
      background: #c6f2
      &:hover { background: #afd6 }
    & > :nth-child(2)
      border-radius: 0 0 15px 15px
      width: 100%


.json-object
  background: #8854
  margin: 0
  padding: 2px
  box-sizing: border-box
  display: inline-flex
  flex-wrap: wrap
  max-width: 100%
  list-style: none
  > *
    max-width: 100%;
  > li
    margin: 3px
    max-width: calc(100% - 10px)
    padding: 0
    display: flex
    flex-direction: column
    align-items: center
    input
      min-width: 100%
      background: #c6f6
      &:last-child { background: #c6f4 }
      &:last-child:hover { background: #c6f6 }
      border-radius: 15px 15px 0 0
      padding: 2px
      font-size: .9em
      border: none
      width: 100%
      text-align: center
    & > :nth-child(2)
      border-radius: 0 0 15px 15px
      width: 100%
